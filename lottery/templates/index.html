{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mainslott</title>
  <!-- <link rel="stylesheet" href="{% static 'style.css' %}"> -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
  body, h1, h2, h3, h4, h5, h6, td, span, label, input, select, button {
    font-family: "Times New Roman", serif !important;
  }
</style>
<style>
  .container,
  .container-fluid,
  .container-lg,
  .container-md,
  .container-sm,
  .container-xl,
  .container-xxl {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }
</style>
<style>
.top-marquee {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 1050;
  background: white;
  padding: 5px 10px;
  font-size: larger;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.main-header {
  position: fixed;
  top: 35px;
  left: 0;
  width: 100%;
  z-index: 1040;
  background-color: #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
   display: flex;
  flex-direction: column;
}
</style>
<style>  
header {
  background-color: #f2f2f2;
  text-align: center;
  position: fixed;
}
html, body {
  height: 100%;
  width: 100%;
  max-width: 100vw;
  margin: 0;
  padding: 0;
}
.head {
    text-align: center;
    margin: 0px auto;
    background-color: #FFA7DC;
    background-image: linear-gradient(to bottom right, #c494d8);
}
td{
    text-align: -webkit-center;
    vertical-align: middle;
}
</style>
<style>
.table>:not(caption)>*>* {
    padding: 0.05rem 0.4rem !important; 
}
.timeSelector {
  display: none;
  background-color: #FFA7DC;
  background-image: linear-gradient(to bottom right, #c494d8);
}

.timeSelector.show {
  display: block;
}

#fullHistoryContent {
  transition: padding-top 0.3s ease;
}
.dropdown-menu {
      z-index: 9999 !important;
      position: absolute;
    }
.page-content.default-padding {
  padding-top: 145px;  
}
.page-content.collapsed-padding {
  padding-top: 111px;  
}
.page-content.expanded-padding {
  padding-top: 145px;
}
</style>
<style>
  /* Base (mobile-first) */
  .text-label {
    font-weight: 600;
  }
  .main-title {
    font-size: 30px !important;
    font-weight: bold;
  }
  .custom-padded-row{
      padding-left: 10px;
      padding-right: 10px;
    }
  @media screen and (max-width: 358px) {
    .smaller-mobile {
      gap: 0rem !important;
    }
    .custom-padded-row{
      padding-left: 10px;
      padding-right: 10px;
    }
    .selectdate{
      width: 88px;
    }
    .nextdraw{
      margin-right: 31px;
    }
    .top-marquee{
        font-size: small;
    }
  }

  @media (max-width: 336px) {
  .smaller-mobile {
    gap: 0 !important;
    justify-content: space-around !important;
    padding: 0 2px !important;
  }

  .smaller-mobile .text-label-mini {
    font-size: 9px !important;
    line-height: 1.1 !important;
  }

  .smaller-mobile .main-title-mini {
    font-size: 12px !important;
  }
  .smaller-mobile .btn-outline-primary {
    padding: 2px 5px !important;
  }
  .small-block {
    min-width: 32% !important;
  }
  .custom-padded-row{
      padding-left: 10px;
      padding-right: 10px;
    }
    .selectdate{
      width: 88px;
    }
  .nextdraw{
  margin-right: 31px;
}
.top-marquee{
        font-size: small;
    }
}
  /* Mobile view ≤576px */
  @media screen and (max-width: 576px) {
    .text-label-mini {
      font-size: 13px;
      font-weight: 600;
      line-height: 1.2;
    }
    .nextdraw1{
      margin-right: 8px;
    }
    .main-title-mini {
      font-size: 18px;
      font-weight: bold;
    }
    .small-block {
      min-width: 30%;
      flex-shrink: 1;
    }
    .form-label,
    .form-control,
    .form-select,
    .btn-sm {
      font-size: 12px !important;
    }
    .small-field label {
      font-size: 12px !important;
    }
    .btn-sm {
      padding: 4px 10px !important;
    }
    #mainForm {
      font-size: 13px;
    }
    .custom-padded-row{
      padding-left: 10px;
      padding-right: 10px;
    }
    .selectdate{
      width: 88px;
    }
    .top-marquee{
        font-size: small;
    }
  }
  /* Medium desktop (992–1400px) - Make it smaller to fit better */
  @media screen and (min-width: 992px) and (max-width: 1400px) {
    .text-label {
      font-size: 19px !important;
      font-weight: 600;
    }
    .main-title {
      font-size: 36px !important;
      font-weight: bold;
    }
    .btn-sm {
      font-size: 16px !important;
      padding: 5px 12px !important;
    }
    .form-label {
      font-size: 20px !important;
    }
    .form-control,
    .form-select {
      font-size: 16px !important;
    }
    .custom-padded-row{
      padding-left: 10px;
      padding-right: 8px;
    }
    .selectdate{
      width: 111px;
    }
    .refreshbtn{
      margin-left: 33px;
    }
    .top-marquee{
        font-size: larger;
    }
  }
  /* Large desktop ≥1401px - Keep your big style */
  @media screen and (min-width: 1401px) {
    .text-label {
      font-size: 30px !important;
      font-weight: 600;
    }
    .main-title {
      font-size: 50px !important;
      font-weight: bold;
    }
    .btn-sm {
      font-size: 18px !important;
      padding: 0px 7px !important;
    }
    .form-label {
      font-size: 25px !important;
    }
    .form-control,
    .form-select {
      font-size: 17px !important;
    }
    .custom-padded-row{
      padding-left: 10px;
      padding-right: 10px;
    }
    .selectdate{
      width: 111px;
    }
    .refreshbtn{
      margin-left: 62px;
    }
    .top-marquee{
        font-size: larger;
    }
  }
</style>
  <style>
  /* .result-cell {
    font-size: 22px;
    font-weight: bold;
    padding: 0px;
  }
  .result-heading{
    font-size: 20px;
  }  */
  .result-cell {
    font-size: 22px;
    font-weight: bold;
    padding: 0px;
  }
  .result-heading{
    font-size: 20px;
  } 
  @media (min-width: 576px) {
    .result-cell {
      font-size: 22px;
      padding: 6px;
    }
    .result-heading{
    font-size: 30px;
    } 
  }
  @media (min-width: 992px) {
    .result-cell {
      font-size: 35px;
      padding: 8px;
    }
    .result-heading{
    font-size: 35px;
    } 
  }
</style>
<style>
  .main-title {
    margin: 0 !important;
    padding: 0 !important;
  }
  .timeHoverZone {
  padding-left: 0 !important;
  padding-right: 0 !important;
}
select.no-arrow {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  background-image: none !important;
  padding-right: 0;  
}
</style>
<style>
/* Mobile responsiveness */
@media screen and (max-width: 768px) {
  .main-header,
  .timeSelector {
    width: 100%;
    box-sizing: border-box;
    padding: 8px;
  }

  .timeSelector {
    display: none;
    background: #FFA7DC;
    background-image: linear-gradient(to bottom right, #c494d8);
    padding: 12px;
  }

  .timeSelector.show {
    display: block;
  }

  .table {
    width: 100% !important;
    font-size: 14px !important;
  }

  .timeHoverZone {
    cursor: pointer;
  }

  .custom-padded-row {
    flex-wrap: wrap;
  }
}
</style>
</head>
<body>
<div class="container-fluid">
  <marquee class="top-marquee" behavior="" direction="" >
      Note :- All the information here is based on Numeric astrology is not related to any type of gambling. Viewing this website is on your own risk. We are not responsible for any issue or scam. We respect all country rules and laws. If you not agree with our site, please quit our site right now..!!
  </marquee>
  <div class="head container-fluid bg-light main-header" id="headerWrapper">
    <!-- desktop view -->
    <div id="fullHistoryWrapper" class="row align-items-center text-center d-none d-lg-flex custom-padded-row">
      <div class="col-md-5 d-flex justify-content-start align-items-center" style="font-weight: 600;">
        <div class="text-label me-4">Time: <span class="currentTime">--:--:--</span></div>
        <div class="text-label">Date: <span>{{ formatted_date }}</span></div>
        <button type="button" class="btn refreshbtn" title="Refresh" onclick="window.location.href = window.location.href;">
          <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
            <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
          </svg>
        </button>
      </div>
      <div class="timeHoverZone col-md-2 d-flex justify-content-center align-items-center px-0">
        <strong class="main-title">MainsLott</strong>
      </div>
      <div class="col-md-5 d-flex justify-content-end align-items-center" style="font-weight: 600;">
        <div class="text-label me-4">Draw Time:<span>{{ selected_time_display }}</span></div>
        <div class="text-label">Next Draw: <span class="nextDraw">--:--:--</span></div>
        <input type="hidden" class="nextDrawTime" value="{{ next_draw_time_str }}">
      </div>
    </div>
    <!-- mobile view -->
    <div class="d-flex d-lg-none flex-row flex-wrap justify-content-between align-items-center text-center gap-2 custom-padded-row">
  <div class="d-flex flex-column align-items-start small-block" style="font-weight: 600;">
    <div class="text-label-mini">Time: <span class="currentTime">--:--:--</span></div>
    <div class="text-label-mini">Date: <span>{{ formatted_date }}</span></div>
  </div>
  <div class="d-flex flex-row align-items-center gap-1 small-block timeHoverZone" style="font-weight: 600;">
    <strong class="timeHoverZone main-title-mini">MainsLott</strong>
    <button type="button" class="btn" style="padding: 0;" onclick="window.location.href = window.location.href;" title="Refresh">
      <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
        <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
      </svg>
    </button>
  </div>
  <div class="d-flex flex-column align-items-end small-block" style="font-weight: 600;">
    <div class="text-label-mini">Draw Time: <span>{{ selected_time_display }}</span></div>
    <div class="text-label-mini nextdraw1">Next Draw: <span class="nextDraw">--:--:--</span></div>
    <input type="hidden" class="nextDrawTime" value="{{ next_draw_time_str }}">
  </div>
</div>
    <section id="timeSelector" class="timeSelector">
      <form method="post" id="mainForm" class="d-flex flex-wrap align-items-center justify-content-center gap-2">
        {% csrf_token %}
        <div class="d-flex flex-row align-items-center small-field" style="margin: 0; padding: 0;">
          <label class="form-label mb-0" for="dateInput" style="margin: 0; padding: 0; font-weight: bold;">Select Date:</label>
          <input type="date" id="dateInput" name="date" value="{{ selected_date }}" class="autoSubmit form-control selectdate"
                style="margin: 0; padding: 0 2px; font-weight: bold;">
        </div>
        <div class="d-flex flex-row align-items-center small-field" style="margin: 0; padding: 0;">
          <label class="form-label mb-0" for="timeInput" style="margin: 0; padding: 0; font-weight: bold;">Select Time:</label>
          <select name="time" id="timeInput" class="autoSubmit form-select form-select-sm no-arrow" onchange="setMode()"
                  style="margin: 0; padding: 0 2px; font-weight: bold; width: auto;">
            <option value="" {% if not selected_time and show_history != '4' %}selected{% endif %}>All Times</option>
            {% for slot in time_slots %}
              <option value="{{ slot }}" {% if slot == selected_time and show_history != '4' %}selected{% endif %}>{{ slot }}</option>
            {% endfor %}
          </select>
        </div>
        <input type="hidden" id="currentSlotTime" value="{{ selected_time }}">
        <button type="button" class="btn btn-success btn-sm"  style="background:#52655c;color:white"  id="btnSingle">SINGLE</button>
        <button type="button" class="btn btn-success btn-sm"  style="background:#52655c;color:white" id="btnTwo">TWO</button>
        <button type="button" class="btn btn-success btn-sm"  style="background:#52655c;color:white" id="btnFull">FULL</button>
          <div class="dropdown dropend">
            <button class="btn btn-success dropdown-toggle btn-sm"  style="background:#52655c;color:white" id="btnHistory" type="button" data-bs-toggle="dropdown">
              HISTORY
            </button>
            <ul class="dropdown-menu">
              <li><button class="dropdown-item" type="button" onclick="setHistoryModeAndSubmit('single')">SINGLE</button></li>
              <li><button class="dropdown-item" type="button" onclick="setHistoryModeAndSubmit('two')">TWO</button></li>
              <li><button class="dropdown-item" type="button" onclick="setHistoryModeAndSubmit('full')">FULL</button></li>
              <li><button class="dropdown-item" type="button" onclick="setHistoryModeAndSubmit('chart')">CHART</button></li>
            </ul>
          </div>
        </div>
        <input type="hidden" name="show_history" id="show_history_input" value="{{ show_history|default:'4' }}">
        <input type="hidden" name="history_mode" id="history_mode_input" value="{{ history_mode|default:'full' }}">
      </form>
    </section>
  </div>
<div class="page-content" id="pageContent">
{% if show_history == "1" or show_history == "2" %}
  {% if has_results %}
    <div id="resultArea">
      <table class="table table-bordered text-center" style="font-weight:bold;border: 1px solid black;">
        <thead>
          <tr>
            <th class="result-cell" style="background-color: #131a3e;color: white;border: 1px solid white;"></th>
            {% for col in column_headers|slice:":10" %}
              <th class="result-cell" style="background-color: #131a3e !important;color: white !important;border: 1px solid white !important;">{{ col }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in grid|slice:":10" %}
            <tr class="result-cell" style="background-color: #131a3e !important;color: white !important;border: 1px solid white !important;">
              <th class="result-cell" style="background-color: #131a3e !important;color: white !important;border: 1px solid white !important;">
                  {{ forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|stringformat:"02d" }}
              </th>
              {% for cell in row %}
                {% if forloop.counter0 == 0 %}
                  <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 1 %}
                  <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 2 %}
                  <td class="result-cell" style="background-color:#85d825; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 3 %}
                  <td class="result-cell" style="background-color:#ea8d9e; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 4 %}
                  <td class="result-cell" style="background-color:#e3a0ef; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 5 %}
                  <td class="result-cell" style="background-color:#d47c8c; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 6 %}
                  <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 7 %}
                  <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 8 %}
                  <td class="result-cell" style="background-color:#5bbfec; font-weight:bold;" align="center">
                {% elif forloop.counter0 == 9 %}
                  <td class="result-cell" style="background-color:#ffa7dc; font-weight:bold;" align="center">
                {% else %}
                  <td>
                {% endif %}
                  {{ cell|default:"--" }}
                  </td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <div class="text-center my-4" style="font-size: larger; font-weight: bold; padding: 30px;">No Results Found...!</div>
  {% endif %}
{% elif show_history == "4" %}
  {% if history_mode == "full" %}
    <div id="historyTable">
      {% if history_data %}
        {% for slot, rows in history_data %}
          <div class="result-heading d-flex justify-content-between align-items-center px-2" style=" font-weight: bold;">
            <div>MainsLott</div>
            <div>{{ slot }}</div>
            <div>{{ selected_date_display }}</div>
          </div>
          <table class="table table-bordered text-center" cellspacing="0" border="2" style="border-collapse:collapse; margin:0 auto;border: 1px solid black;">
            <tbody>
              {% for row in rows %}
                <tr>
                  {% for cell in row %}
                    {% if forloop.counter0 == 0 %}
                      <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 1 %}
                      <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 2 %}
                      <td class="result-cell" style="background-color:#85d825; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 3 %}
                      <td class="result-cell" style="background-color:#ea8d9e; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 4 %}
                      <td class="result-cell" style="background-color:#e3a0ef; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 5 %}
                      <td class="result-cell" style="background-color:#d47c8c; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 6 %}
                      <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 7 %}
                      <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 8 %}
                      <td class="result-cell" style="background-color:#5bbfec; font-weight:bold;" align="center">
                    {% elif forloop.counter0 == 9 %}
                      <td class="result-cell" style="background-color:#ffa7dc; font-weight:bold;" align="center">
                    {% else %}
                      <td>
                    {% endif %}
                      {{ cell.number|default:"--" }}
                    </td>
                  {% endfor %}
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% endfor %}
      {% else %}
        <div class="text-center my-4" style="font-size: larger; font-weight: bold; padding: 30px;">No Results Found...!</div>
      {% endif %}
    </div>
  {% elif history_mode == "chart" %}
    {% if chart_data %}
      <div id="chartbuttons" class="container chart_table my-3 ">
        <form method="post" id="chartForm">
          {% csrf_token %}
          <input type="hidden" name="history_mode" value="chart" />
          <div class="row g-2 justify-content-center">
            {% for i in "0123456789"|make_list %}
              <div class="col-4 col-sm-3 col-md-2 col-lg-1 d-flex justify-content-center">
                <button type="submit" name="chart_prefix" value="{{ i }}0" class="btn btn-warning w-100">
                  {{ i }}0
                </button>
              </div>
            {% endfor %}
          </div>
        </form>
      </div>
      <table class="table table-bordered text-center">
        <thead>
          <tr>
            <th class="result-cell" style="background-color: #131a3e;color: white;border: 1px solid white;">TIME</th>
            {% for i in "0123456789"|make_list %}
              <th class="result-cell" style="background-color: #131a3e;color: white;border: 1px solid white;">{{ selected_chart_prefix|add:i }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody style="border: 1px solid black;">
          {% for time_label, row in chart_data %}
            <tr>
              <td class="result-cell" style="background-color: #131a3e;color: white;border: 1px solid white;">{{ time_label }}</td>
              {% for value in row %}
                {% if forloop.counter0 == 0 %}
                  <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 1 %}
                  <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 2 %}
                  <td class="result-cell" style="background-color:#85d825; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 3 %}
                  <td class="result-cell" style="background-color:#ea8d9e; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 4 %}
                  <td class="result-cell" style="background-color:#e3a0ef; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 5 %}
                  <td class="result-cell" style="background-color:#d47c8c; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 6 %}
                  <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 7 %}
                  <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 8 %}
                  <td class="result-cell" style="background-color:#5bbfec; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% elif forloop.counter0 == 9 %}
                  <td class="result-cell" style="background-color:#ffa7dc; font-weight:bold;" align="center">{{ value|default:"--" }}</td>
                {% else %}
                  <td>{{ value|default:"--" }}</td>
                {% endif %}
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <div class="text-center my-4" style="font-size: larger; font-weight: bold; padding: 30px;">No Results Found...!</div>
    {% endif %}
        <!-- single & two historydata -->
        <div>
        {% for label, grid in history_data %}
            <div class="result-heading d-flex justify-content-between align-items-center px-3 " style="font-weight: bold;">
              <div>MainsLott</div>
              <div>{{ label }}</div>
              <div>{{ selected_date_display }}</div>
            </div>
            <div>
              <table class="result-cell table table-bordered text-center" style="margin-bottom: 0px;font-weight:bold;border: 1px solid black;">
                <thead class="result-cell" style="background-color: #131a3e;color: white;border: 1px solid white;">
                  <tr>
                    <th class="result-cell" style="background-color: #131a3e;color: white;border: 1px solid white;"></th>
                    {% for col in column_headers|slice:":10" %}
                      <th class="result-cell" style="background-color: #131a3e;color: white;border: 1px solid white;">{{ col }}</th>
                    {% endfor %}
                  </tr>
                </thead>
                <tbody>
                  {% for row in grid|slice:":10" %}
                    <tr>
                      <th style="background-color: #131a3e;color: white;border: 1px solid white;">
                        {{ forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|add:forloop.counter0|stringformat:"02d" }}
                      </th>
                      {% for cell in row %}
                        {% if forloop.counter0 == 0 %}
                          <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 1 %}
                          <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 2 %}
                          <td class="result-cell" style="background-color:#85d825; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 3 %}
                          <td class="result-cell" style="background-color:#ea8d9e; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 4 %}
                          <td class="result-cell" style="background-color:#e3a0ef; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 5 %}
                          <td class="result-cell" style="background-color:#d47c8c; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 6 %}
                          <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 7 %}
                          <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 8 %}
                          <td class="result-cell" style="background-color:#5bbfec; font-weight:bold;" align="center">
                        {% elif forloop.counter0 == 9 %}
                          <td class="result-cell" style="background-color:#ffa7dc; font-weight:bold;" align="center">
                        {% else %}
                        {% endif %}
                          {{ cell|default:"--" }}
                          </td>
                      {% endfor %}
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
          </div>
        {% endfor %}
      {% else %}
        <div class="text-center my-4" style="font-size: larger; font-weight: bold; padding: 30px;">No Results Found...!</div>
      {% endif %}
    </div>
    {% else %}
<!-- Full table button -->
<div id="fullHistoryContent">
  {% if results_exist %}
    <table class="table table-bordered text-center" cellspacing="0" rules="all" border="1" id="GridView1" style="border-collapse:collapse;margin:0 auto;border: 1px solid black;">
      {% for row in grid %}
        <tr>
          {% for cell in row %}
            {% if forloop.counter0 == 0 %}
              <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 1 %}
              <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 2 %}
              <td class="result-cell" style="background-color:#85d825; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 3 %}
              <td class="result-cell" style="background-color:#ea8d9e; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 4 %}
              <td class="result-cell" style="background-color:#e3a0ef; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 5 %}
              <td class="result-cell" style="background-color:#d47c8c; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 6 %}
              <td class="result-cell" style="background-color:#ecd4d8; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 7 %}
              <td class="result-cell" style="background-color:#FFEB3B; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 8 %}
              <td class="result-cell" style="background-color:#5bbfec; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% elif forloop.counter0 == 9 %}
              <td class="result-cell" style="background-color:#ffa7dc; font-weight:bold;" align="center">{{ cell.number|default:"--" }}</td>
            {% endif %}
          {% endfor %}
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <div class="text-center my-4" style="font-size: larger; font-weight: bold; padding: 30px;">
      No Results Found...!
    </div>
  {% endif %}
</div>
    {% endif %}
</div>
</div>
<!-- <footer>
  <p style="margin-top: 0;margin-bottom: 0rem;">&copy; 2025 Mainslott.in</p>
</footer> -->
<script>
function updateTimes() {
  const now = new Date();
  const kolkataTime = new Date(now.toLocaleString("en-US", { timeZone: "Asia/Kolkata" }));

  // Format current time in 12-hour
  let hour = kolkataTime.getHours();
  const minute = kolkataTime.getMinutes();
  const second = kolkataTime.getSeconds();

  let hour12 = hour % 12;
  hour12 = hour12 === 0 ? 12 : hour12;

  const formattedTime = `${String(hour12).padStart(2,'0')}:${String(minute).padStart(2,'0')}:${String(second).padStart(2,'0')}`;
  document.querySelectorAll(".currentTime").forEach(el => {
    el.textContent = formattedTime;
  });

  // Get the nextDrawTime input
  const nextDrawInput = document.querySelector(".nextDrawTime");
  if (!nextDrawInput) return;

  let targetDrawTime = new Date(nextDrawInput.value);

  // Define 9:00 AM and 9:30 PM in Kolkata timezone
  const todayNineAM = new Date(kolkataTime);
  todayNineAM.setHours(9,0,0,0);

  const todayNineThirtyPM = new Date(kolkataTime);
  todayNineThirtyPM.setHours(21,30,0,0);

  // Define tomorrow 9:00 AM
  const tomorrowNineAM = new Date(kolkataTime);
  tomorrowNineAM.setDate(tomorrowNineAM.getDate() + 1);
  tomorrowNineAM.setHours(9,0,0,0);

  // After 9:30 PM or invalid/past target: switch to tomorrow 9:00 AM
  if (kolkataTime >= todayNineThirtyPM || targetDrawTime <= kolkataTime) {
    targetDrawTime = tomorrowNineAM;
  }

  // Calculate difference
  const diffMs = targetDrawTime - kolkataTime;
  if (diffMs <= 0) {
    location.reload();
    return;
  }

  const totalSeconds = Math.floor(diffMs / 1000);
  const hours = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
  const minutes = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
  const seconds = String(totalSeconds % 60).padStart(2, '0');

  let countdown;
  if (kolkataTime >= todayNineAM && kolkataTime < todayNineThirtyPM) {
    // Between 9:00 AM and 9:30 PM - show MM:SS
    countdown = `${minutes}:${seconds}`;
  } else {
    // After 9:30 PM till next morning 9:00 AM - show HH:MM:SS
    countdown = `${hours}:${minutes}:${seconds}`;
  }

  document.querySelectorAll(".nextDraw").forEach(el => {
    el.textContent = countdown;
  });
}

setInterval(updateTimes, 1000);
updateTimes();
</script>
<script>
function setHistoryModeAndSubmit(mode) {
  document.getElementById('history_mode_input').value = mode;
  document.getElementById('mainForm').submit();
}
function setResultsModeAndSubmit(mode) {
  document.getElementById('results_mode_input').value = mode;
  document.getElementById('mainForm').submit();
}

document.getElementById("btnSingle").onclick = function () {
  document.getElementById("show_history_input").value = "1";
  document.getElementById("history_mode_input").value = ""; 
  document.getElementById("mainForm").submit();
};

document.getElementById("btnTwo").onclick = function () {
  document.getElementById("show_history_input").value = "2";
  document.getElementById("history_mode_input").value = "";
  document.getElementById("mainForm").submit();
};

document.getElementById("btnFull").onclick = function () {
  document.getElementById("show_history_input").value = "3";
  document.getElementById("history_mode_input").value = "";
  document.getElementById("mainForm").submit();
};

function setHistoryModeAndSubmit(mode) {
  document.getElementById('show_history_input').value = "4";  
  document.getElementById('history_mode_input').value = mode;
  document.getElementById('mainForm').submit();
}
</script>
<script>
function setMode() {
  const timeInput = document.getElementById("timeInput");
  const modeInput = document.getElementById("modeInput");

  if (timeInput.value === "") {
    if (!modeInput.value) {
      modeInput.value = "full";
    }
  } else {
    if (!modeInput.value) {
      modeInput.value = "full";  
    }
  }
}
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const buttons = document.querySelectorAll(".chartbutton");
    buttons.forEach(button => {
      button.addEventListener("click", function () {
        const start = parseInt(this.dataset.chartNumber);
        const end = start + 10;


        for (let col = 0; col < 10; col++) {
          const show = (col >= start / 10 && col < end / 10);
          const headerCell = document.querySelector(`.chart-column.chart${col}`);
          if (headerCell) {
            headerCell.style.display = show ? "table-cell" : "none";
          }
          const bodyCells = document.querySelectorAll(`.chart-column.valuetd.chart${col}`);
          bodyCells.forEach(cell => {
            cell.style.display = show ? "table-cell" : "none";
          });
        }
      });
    });

    // const showHistory = "{{ show_history }}";
    // const historyMode = "{{ history_mode }}";

    // if (showHistory === "4" && historyMode === "full") {
    //   document.getElementById("show_history_input").value = "4";
    //   document.getElementById("history_mode_input").value = "full";
    // }
    // else {
    //   document.getElementById("show_history_input").value = "3"; 
    //   document.getElementById("history_mode_input").value = "";
    // }
  });
</script>
<script>
  window.addEventListener('load', function () {
    // Only auto-submit if it's a fresh page load (not from history or a back button)
    if (!window.performance || window.performance.navigation.type === 1) {
      // Set FULL mode explicitly (if not already in context)
      document.getElementById('show_history_input').value = '3';
      document.getElementById('history_mode_input').value = '';
      document.getElementById('mainForm').submit();
    }
  });
</script> 
<script>
document.addEventListener("DOMContentLoaded", function () {
  const showHistory = "{{ show_history }}";
  const timeSelector = document.querySelector(".timeSelector");
  const pageContent = document.getElementById("pageContent");
  const hoverZones = document.querySelectorAll(".timeHoverZone");
  const headerWrapper = document.getElementById("headerWrapper");
  const isMobile = window.innerWidth <= 768;

  function showTimeSelector() {
    timeSelector?.classList.add("show");
    if (pageContent) {
      pageContent.classList.remove("collapsed-padding");
      pageContent.classList.add("expanded-padding");
    }
  }
  function hideTimeSelector() {
    timeSelector?.classList.remove("show");
    if (pageContent) {
      pageContent.classList.remove("expanded-padding");
      pageContent.classList.add("collapsed-padding");
    }
  }

  if (isMobile) {
    if (showHistory === "3") {
      timeSelector?.classList.remove("show"); // Start hidden
      hoverZones.forEach(zone => {
        zone.addEventListener("click", () => {
          if (timeSelector?.classList.contains("show")) {
            timeSelector.classList.remove("show");
          } else {
            timeSelector.classList.add("show");
            window.scrollTo({ top: 0, behavior: "smooth" });
          }
        });
      });
    } else {
      // Always show for mobile if not "3"
      timeSelector?.classList.add("show");
    }
  } else {
    // DESKTOP
    if (showHistory === "3") {
      hideTimeSelector();
      headerWrapper?.addEventListener("mouseenter", showTimeSelector);
      headerWrapper?.addEventListener("mouseleave", hideTimeSelector);
    } else {
      showTimeSelector();
    }
  }
});
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const dateInput = document.getElementById("dateInput");
    const timeInput = document.getElementById("timeInput");

    dateInput.addEventListener("change", function () {
      document.getElementById("mainForm").submit();
    });

    timeInput.addEventListener("change", function () {
      document.getElementById("mainForm").submit();
    });
  });
</script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const autoInputs = document.querySelectorAll(".autoSubmit");

    autoInputs.forEach((element) => {
      element.addEventListener("change", function () {
        if (element.id === "timeInput") {
          setMode(); 
        }
        document.getElementById("mainForm").submit();
      });
    });
  });

</script>
<script>
let nextDrawTimeStr = document.querySelector(".nextDrawTime").value;
function showBlackScreen() {
  const overlay = document.createElement('div');
  overlay.style.position = "fixed";
  overlay.style.top = 0;
  overlay.style.left = 0;
  overlay.style.width = "100vw";
  overlay.style.height = "100vh";
  overlay.style.backgroundColor = "black";
  overlay.style.opacity = "1";
  overlay.style.zIndex = "9999";
  document.body.appendChild(overlay);
  setTimeout(() => {
    overlay.style.transition = "opacity 1s";
    overlay.style.opacity = "0";
    setTimeout(() => overlay.remove(), 1000);
  }, 2000);
}

function updateCountdown(newSeconds) {
  const countdown = document.querySelector(".nextDraw");
  if (countdown) {
    let minutes = Math.floor(newSeconds / 60);
    let seconds = newSeconds % 60;
    countdown.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
  }
}

//async function pollNextDrawTime() {
  //try {
    //const response = await fetch("{% url 'next_draw_time_api' %}");
    //const data = await response.json();

    //if (data.next_draw_time_str) {
      //if (data.next_draw_time_str !== nextDrawTimeStr) {
        // It changed → show black screen and reload ONCE
        //showBlackScreen();
        //setTimeout(() => location.reload(), 2000);
        // STOP here! Don't update local variable (so after reload it's correct)
        //return;
      //}

      // Only update countdown if no change
     // updateCountdown(data.total_seconds);
    //}
  //} catch (error) {
   // console.error("Polling error:", error);
  //}
//}
setInterval(pollNextDrawTime, 5000);
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const headerZone = document.querySelector(".timeHoverZone");
  const timeSelector = document.querySelector(".timeSelector");

  if (window.innerWidth <= 768 && headerZone && timeSelector) {
    headerZone.addEventListener("click", () => {
      timeSelector.classList.toggle("show");
    });
  }
});
</script>
</body>
</html>
